---
title: "Mantis Shrimp Mini Project"
output: html_document
---

---
Many types of animals develop morphological traits to partake in ritualized combat, which is essentially combat over territory or rights. These traits are usually meant for offence, for example horns on a deer. Examples of distinct armour for ritualized fighting are rare, but mantis shrimp present an interesting case in which their unique form of ritualized combat, termed telson sparring, may have coevolved with specialized morphological armour.
During telson sparring, mantis shrimp take turns striking with their raptorial appendages against the telson, or tailplate, of their opponent. Individuals direct nearly every strike to the telson, and this is facilitated by the recipient assuming a coiled position referred to as a ‘telson coil’
---

## Required Packages

```{r, message=FALSE, warning=FALSE}
library(dplyr)
library(ggplot2)
```

## Data
```{r}
data_1 <- read.csv("https://ndownloader.figshare.com/files/16851587")
```

## Analysis
```{r, message=FALSE, warning=FALSE}

smasher_data <- data_1 %>%
  group_by(appendage) %>%
  filter(appendage == "smasher") #strings need quotes 

spearer_data <- data_1 %>%
  group_by(appendage) %>%
  filter(appendage != "smasher")

lm_1 <- lm(cor.telson~cor.abdomen, data_1) #linear model function 
summary(lm_1)[[9]] #number assocaited with chunk, returns r squared value

results <- summary(lm_1) 
results$coefficients[8] #returns p value

lm_2 <- lm(cor.telson~cor.abdomen, smasher_data) #linear model function 
summary(lm_2)[[9]] #number assocaited with chunk, returns r squared value

results_2 <- summary(lm_2) 
results_2$coefficients[8] #returns p value

lm_3 <- lm(cor.telson~cor.abdomen, spearer_data) #linear model function 
summary(lm_3)[[9]] #number assocaited with chunk, returns r squared value

results_3 <- summary(lm_3) 
results_3$coefficients[8] #returns p value

#Plot of all 
ggplot(data_1, aes(x=cor.abdomen,y=cor.telson))+
  geom_point(shape=1)+
  geom_smooth(method=lm)

ggsave("../figures/all_data.jpg")

#Plot of Smashers
ggplot(smasher_data, aes(x=cor.abdomen,y=cor.telson))+
  geom_point(shape=1)+
  geom_smooth(method=lm)

ggsave("../figures/smasher_data.jpg")

#Plot of Spearers
ggplot(spearer_data, aes(x=cor.abdomen,y=cor.telson))+
  geom_point(shape=1)+
  geom_smooth(method=lm)

ggsave("../figures/spearer_data.jpg")
  
```



